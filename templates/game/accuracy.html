{% extends 'base.html' %}
{% load static %}
{% block title %}Тест{% endblock title %}
{% block content %}
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const height = window.getComputedStyle(tag).lineHeight
      const paddings = parseInt(window.getComputedStyle(typingForm).paddingTop) + parseInt
      (window.getComputedStyle(typingForm).paddingBottom)
      document.getElementById('typing_form').style.cssText = `height: ${parseFloat(height) * 5 +
      paddings}px; overflow: hidden`
    })
  </script>
  <div class="flex justify-center gap-12 mt-8">
    <div>
      <h1
        id="timer"
        class="mb-4 text-center text-4xl font-extrabold leading-none tracking-tight text-gray-900
        md:text-5xl lg:text-6xl dark:text-white"
      ></h1>
      {% include 'includes/typing_form.html' %}
      <div id="root"></div>
    </div>
    <form id="text_form" method="post">
      {{ form.errors }}
      {% csrf_token %}
      {{ form.score }}
      {{ form.speed }}
      {{ form.accuracy }}
{#      <button#}
{#        id="dropdownDefault"#}
{#        data-dropdown-toggle="dropdown"#}
{#        type="button"#}
{#        class="inline-flex items-center px-4 py-2.5 bg-blue-700 rounded-lg text-sm#}
{#        text-center font-medium text-white hover:bg-blue-800 focus:ring-4 focus:outline-none#}
{#        focus:ring-blue-300 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"#}
{#      >#}
{#        Настройки#}
{#        <svg aria-hidden="true" fill="currentColor" viewBox="0 0 600 600" class="w-4 h-4 ml-2">#}
{#          <path d="M20.29 8.567c.133.323.334.613.59.85v.002a3.536 3.536 0 0 1 0 5.166 2.442 2.442 0 0 0-.776 1.868 3.534 3.534 0 0 1-3.651 3.653 2.483 2.483 0 0 0 -1.87.776 3.537 3.537 0 0 1-5.164 0 2.44 2.44 0 0 0-1.87-.776 3.533 3.533 0 0 1-3.653-3.654 2.44 2.44 0 0 0-.775-1.868 3.537 3.537 0 0 1 0-5.166 2.44 2.44 0 0 0.775-1.87 3.55 3.55 0 0 1 1.033-2.62 3.594 3.594 0 0 1 2.62-1.032 2.401 2.401 0 0 0 1.87-.775 3.535 3.535 0 0 1 5.165 0 2.444 2.444 0 0 0 1.869.775 3.532 3.532 0 0 1 3.652 3.652c-.012.35.051.697.184 1.02ZM9.927 7.371a1 1 0 1 0 0 2h.01a1 1 0 0 0 0-2h-.01Zm5.889 2.226a1 1 0 0 0-1.414 -1.415L8.184 14.4a1 1 0 0 0 1.414 1.414l6.218-6.217Zm-2.79 5.028a1 1 0 1 0 0 2h.01a1 1 0 1 0 0-2h-.01Z"/>#}
{#          <path d="m-899.99998,-310.79461c-20.43409,0-40.0078,4.62259-52.90398,19.2757-12.89618,14.65312 -13.31011,30.27623 -14.05636,39.78187 -0.74624,9.50565-1.36732,15.42265 -2.80675,19.0879 -1.43942,3.66526 -2.62672,6.46545 -11.63186,11.66458-9.00514,5.19911 -12.02109,4.82429 -15.91499,4.23825 -3.89398,-0.58605-9.32638,-3.00427 -17.93168,-7.11083 -8.6053,-4.10655 -22.3462,-11.56116 -41.4843,-7.71929 -19.138,3.84186 -32.9287,18.48118 -43.1458,36.17762 -10.2171,17.69644-15.9985,36.95986 -9.7566,55.45483 6.2418,18.49497 19.5659,26.66798 27.4249,32.06708 7.859,5.39908 12.6704,8.893362 15.1249,11.972567 2.4545,3.079205 4.2876,5.506097 4.2876,15.904332 0,10.398237 -1.8331,12.825128 -4.2876,15.904333 -2.4545,3.079204 -7.2659,6.57348 -15.1249,11.972569-7.859,5.39909-21.1831,13.572101-27.4249,32.067077-6.2419,18.4949758-0.4605,37.758386 9.7566,55.454828 10.2171,17.696443 24.0078,32.335764 43.1458,36.177623 19.1381,3.84186 32.879,-3.612739 41.4843,-7.719295 8.6053,-4.106556 14.0377,-6.52478 17.93168,-7.110826 3.8939,-0.586047 6.90985,-0.960867 15.91499,4.238251 9.00514,5.199118 10.19243,7.999328 11.63186,11.664579 1.43943,3.665252 2.06051,9.582259 2.80675,19.087903 0.74625,9.505639 1.16018,25.128749 14.05636,39.781869 12.89618,14.65311 32.46989,19.2757 52.90398,19.2757 20.43409,0 40.0078,-4.62259 52.90398,-19.2757 12.89617,-14.65312 13.31011,-30.27623 14.05635,-39.781869 0.74624,-9.505644 1.36733,-15.422651 2.80676,-19.087903 1.43942,-3.665251 2.62672,-6.465461 11.63186,-11.664579 9.00513,-5.199119 12.02108,-4.824297 15.91499,-4.238251 3.89392,0.586046 9.32639,3.004271 17.93164,7.110826 8.60525,4.106555 22.34625,11.561156 41.48432,7.719295 19.13806,-3.84186 32.92874,-18.481179 43.14579,-36.177623 10.21705,-17.696442 15.99856,-36.9598523 9.75668,-55.454828-6.24189,-18.494976-19.56594,-26.667988-27.42495,-32.067077 -7.859,-5.399088-12.67039,-8.893365 -15.12488,-11.972569-2.45449,-3.079205 -4.28764,-5.506097-4.28764,-15.904333 0,-10.398236 1.83315,-12.825127 4.28764,-15.904332 2.45449,-3.079205 7.26588,-6.573487 15.12488,-11.972567 7.85901,-5.3991 21.18307,-13.57211 27.42495,-32.06708 6.24188,-18.49497 0.46037,-37.75839-9.75668,-55.45483-10.21705,-17.69644-24.00773,-32.33576-43.14579,-36.17762-19.13807,-3.84186-32.87907,3.61274-41.48432, 7.71929 -8.60525,4.10656-14.03772,6.52478-17.93164,7.11083-3.89391,0.58604-6.90986,0.96086-15.91499,-4.23825-9.00514,-5.19913-10.19243,-7.99932-11.63186,-11.66458-1.43943,-3.66525 -2.06052,-9.58225-2.80676,-19.0879 -0.74624,-9.50564-1.16018,-25.12875-14.05635,-39.78187-12.89618,-14.65311-32.46989,-19.2757-52.90398,-19.2757zm0.0181,130.78031c55.63168,0 100.16735,44.4506 100.16735,100.014299 0,55.563699-44.53567,100.014302-100.16735,100.014302-55.63168,0-100.16738,-44.450603-100.16738,-100.014302 0,-55.563699 44.5357,-100.014299 100.16738,-100.014299 z" transform="matrix(1.3636076,0,0,1.3667651,1527.8554,411.9526)"/>#}
{#          <path d="m300.60937,218.51428c-46.03938,0-84.05805,38.06434-84.05805,84.09712 0,46.03278 38.01867,84.09711 84.05805,84.09711 46.03938,0 84.05649,-38.06433 84.05649,-84.09711 0,-46.03278-38.01711,-84.09712-84.05649,-84.09712z"/>#}
{#        </svg>#}
{#      </button>#}
      <div{# id="dropdown" #} class="{# lg:block hidden #} w-56 p-3 bg-white z-10 rounded-lg shadow dark:bg-gray-700">
        <h6 class="mb-3 text-sm font-medium text-gray-900 dark:text-white">
          {{ form.mode.label }}
        </h6>
        <ul class="space-y-2 text-sm" aria-labelledby="dropdownDefault">
          {% for mode in form.mode %}
            <li class="flex items-center">
              {{ mode.tag }}
              <label
                for="{{ form.mode.auto_id }}_{{ forloop.counter0 }}"
                class="inline-flex justify-between items-center w-full bg-white border
                border-gray-200 rounded-lg text-gray-500 cursor-pointer hover:bg-gray-100
                hover:text-gray-600 peer-checked:border-blue-600 peer-checked:text-blue-600
                dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700
                dark:hover:text-gray-300 dark:peer-checked:text-blue-500"
              >
                <span class="block w-full text-lg text-center font-semibold">
                  {{ mode.choice_label }}
                </span>
              </label>
            </li>
          {% endfor %}
        </ul>

        <h6 class="my-3 text-sm font-medium text-gray-900 dark:text-white">
          {{ form.timer.label }}
        </h6>
        <ul class="space-y-2 text-sm" aria-labelledby="dropdownDefault">
          {% for timer in form.timer %}
            <li class="flex items-center">
              {{ timer.tag }}
              <label
                for="{{ form.timer.auto_id }}_{{ forloop.counter0 }}"
                class="inline-flex justify-between items-center w-full bg-white border
                border-gray-200 rounded-lg text-gray-500 cursor-pointer hover:bg-gray-100
                hover:text-gray-600 peer-checked:border-blue-600 peer-checked:text-blue-600
                dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700
                dark:hover:text-gray-300 dark:peer-checked:text-blue-500"
              >
                <span class="block w-full text-lg text-center font-semibold">
                  {{ timer.choice_label }}
                </span>
              </label>
            </li>
          {% endfor %}
        </ul>
        <h6 class="my-3 text-sm font-medium text-gray-500 dark:text-white">Клавиатура</h6>
        <button id="key_switch" class="rounded" type="button">
          <svg aria-hidden="true" fill="currentColor" viewBox="0 0 24 24" class="w-8 h-8">
            <path fill-rule="evenodd" d="M2 7a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V7Zm5.01 1H5v2.01h2.01V8Zm3 0H8v2.01h2.01V8Zm3 0H11v2.01h2.01V8Zm3 0H14v2.01h2.01V8Zm3 0H17v2.01h2.01V8Zm-12 3H5v2.01h2.01V11Zm3 0H8v2.01h2.01V11Zm3 0H11v2.01h2.01V11Zm3 0H14v2.01h2.01V11Zm3 0H17v2.01h2.01V11Zm-12 3H5v2.01h2.01V14ZM8 14l-.001 2 8.011.01V14H8Zm11.01 0H17v2.01h2.01V14Z" clip-rule="evenodd"/>
          </svg>
        </button>
      </div>
    </form>
  </div>
{% endblock content %}
{% block scripts %}
  {% include 'includes/keyboard.html' %}
  <script src="{% static 'scripts/vendor/react.development.js' %}"></script>
  <script src="{% static 'scripts/vendor/react-dom.development.js' %}"></script>
  <script src="{% static 'scripts/vendor/babel.min.js' %}"></script>
  <script src="{% static 'scripts/slicer.js' %}"></script>
  <script src="{% static 'scripts/keycaps.js' %}"></script>
  <script src="{% static 'scripts/compare.js' %}"></script>
  <script src="{% static 'scripts/cursor.js' %}"></script>
  <script src="{% static 'scripts/game/compare.js' %}"></script>
  <script src="{% static 'scripts/words.min.js' %}"></script>
  <script>
    const keySwitch = document.getElementById('key_switch');
    if (localStorage.getItem('keyboard') === 'on') {
      document.getElementById('root').classList.remove('hidden')
      Object.assign(keySwitch, {
        className: 'text-blue-600'
      })
    } else {
      document.getElementById('root').classList.add('hidden')
      Object.assign(keySwitch, {
        className: 'text-gray-500'
      })
    }
    keySwitch.addEventListener('click', () => {
      {#if (localStorage.getItem('keyboard')) {#}
        if (localStorage.getItem('keyboard') === 'off') {
          Object.assign(keySwitch, {
            className: 'text-blue-600'
          })
          localStorage.setItem('keyboard', 'on')
          document.getElementById('root').classList.remove('hidden')
        } else {
          Object.assign(keySwitch, {
            className: 'text-gray-500'
          })
          localStorage.setItem('keyboard', 'off')
          document.getElementById('root').classList.add('hidden')
        }
      {# }#}
    })
    setContent(modeField.value)
  </script>
{% endblock scripts %}