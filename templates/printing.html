{% extends 'base.html' %}
{% load static %}
{% block title %}
  {{ book.name }}
{% endblock title %}
{% block content %}
  <style>
      p {
          margin: 6px 0;
          font-weight: 400;
          line-height: 1.4;
          font-family: "Open Sans", sans-serif;
          font-size: 17px;
          text-indent: 35px;
      }

      .text-center {
          text-align: center;
      }

      #text-container {
          margin: 0 auto;
          width: 751px;
          height: 320px;
          scrollbar-width: none;
          overflow: auto;
          padding: 10px;
      }
  </style>
  <form id="text-form" method="post">
    {% csrf_token %}
    {{ form }}
  </form>
  <div id="text-container" contenteditable="true" onselectstart="return false" onCut="return false"
       onpaste="return false;" onCopy="return false" onDrag="return false" onDrop="return false"
       onblur="this.focus()" autofocus>
  </div>
  <script src="{% static 'scripts/slicer.js' %}"></script>
  <script src="{% static 'scripts/elements.js' %}"></script>
  <script>
    let htmlTag

    {% for data in content %}
      htmlTag = document.createElement(`{{ data.type.tag }}`)

      {% if data.type.css %}
        htmlTag.setAttribute('class', '{{ data.type.css }}')
      {% endif %}

      {% if data.type.src %}
        htmlTag.setAttribute('src', '{{ data.type.src.url }}')
      {% endif %}
      htmlTag.nodeName !== 'IMG' ? htmlTag.innerHTML = slicer(`{{ data.text|safe }}`) : null
      textContainer.appendChild(htmlTag)
    {% endfor %}
  </script>
  {% include 'keyboard.html' %}
{% endblock content %}